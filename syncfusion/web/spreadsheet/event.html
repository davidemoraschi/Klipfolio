<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title>Essential Studio for JavaScript : Event</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" charset="utf-8" />
    <link href="../themes/bootstrap.min.css" rel="stylesheet" />
    <link href="../themes/default-theme/ej.widgets.all.min.css" rel="stylesheet" />
    <link href="../themes/default.css" rel="stylesheet" />
    <link href="../themes/default-responsive.css" rel="stylesheet" />
    <!--[if lt IE 9]>
    	<script src="../scripts/jquery-1.11.3.min.js" type="text/javascript" ></script> 
    <![endif]-->
    <!--[if IE 9]><!-->
    	<script src="../scripts/jquery-2.1.4.min.js" type="text/javascript"> </script>
    <!--<![endif]-->
    <script src="../scripts/jquery.globalize.min.js"></script>
    <script src="../scripts/jquery.easing.1.3.min.js"></script>
    <script src="../scripts/jsrender.min.js"></script>
    <script src="../scripts/jquery.validate.min.js"></script>
    <script src="../scripts/jquery.validate.unobtrusive.min.js"></script>
    <script src="../scripts/ej.web.all.min.js" type="text/javascript"></script>
    <script src="../scripts/properties.js" type="text/javascript"></script>
    <script src="../scripts/xljsondata.js" type="text/javascript"></script>
	<style type="text/css">
		.cols-sample-area {
			height: 90%;
		}
	</style>
    <script>
        var ddObj, xlObj;
        $(function () {
            $("#Spreadsheet").ejSpreadsheet({
                columnWidth: 60,
                allowFormulaBar: false,
                showRibbon: false,
                scrollSettings:
                {
                    width: "100%",
                    height: 550,
					isResponsive: true
                },
                sheets: [{ rangeSettings: { dataSource: window.eventData, startCell: "A1", showHeader: true, }}],
                actionBegin: "actionBegin",
                actionComplete: "actionComplete",
                beforeCellFormat: "beforeCellFormat",
                beforeOpen: "beforeOpen",
                drag: "drag",
                cellEdit: "cellEdit",
                beforePanelOpen: "beforePanelOpen",
                cellClick: "cellClick",
                contextMenuClick: "contextMenuClick",
                onLoad: "onLoad",
                onLoadComplete: "onLoadComplete",
                editRangeBegin: "editRangeBegin",
                editRangeComplete: "editRangeComplete",
                onCellHover: "onCellHover",
                cellSave: "cellSave",
                beforeCellSelect: "beforeCellSelect",
            });
            $("#selectControls").ejDropDownList(
                    {
                        customCssClass: "metroblue",
                        popupShown: "adjustpopupposition",
                        showCheckbox: true,
                        checkAll: true,
                        change: "changeevent"
                    });
            xlObj = $("#Spreadsheet").data("ejSpreadsheet");
            ddObj = $("#selectControls").data("ejDropDownList");
            ddObj.unselectItemByIndex(13);
            ddObj.unselectItemByIndex(15);
            xlObj.XLFormat.format({ "style": { "font-weight": "bold", "font-size": "12px", "vertical-align": "middle", "text-align": "center", "background-color": "#559ad9", "color": "#FFFFFF" } }, "A1:H1");
            xlObj.setWidthToColumns([{ cellIndex: 0, width: 130 }, { cellIndex: 1, width: 140 }, { cellIndex: 2, width: 140 }, { cellIndex: 3, width: 130 }, { cellIndex: 4, width: 120 }, { cellIndex: 5, width: 120 }, { cellIndex: 6, width: 110 }, { cellIndex: 7, width: 110 }]);         
			xlObj.setActiveCell(1, 0);
			xlObj.performSelection({ rowIndex: 1, colIndex: 0 }, { rowIndex: 1, colIndex: 0 });
        });
        function changeevent(args) {
            if (args.isChecked && xlObj != undefined) {
                switch (args.value) {
                    case "actionBegin": xlObj.option(args.value, "actionBegin"); break;
                    case "actionComplete": xlObj.option(args.value, "actionComplete"); break;
                    case "beforeCellFormat": xlObj.option(args.value, "beforeCellFormat"); break;
                    case "beforeOpen": xlObj.option(args.value, "beforeOpen"); break;
                    case "drag": xlObj.option(args.value, "drag"); break;
                    case "cellEdit": xlObj.option(args.value, "cellEdit"); break;
                    case "beforePanelOpen": xlObj.option(args.value, "beforePanelOpen"); break;
                    case "cellClick": xlObj.option(args.value, "cellClick"); break;
                    case "contextMenuClick": xlObj.option(args.value, "contextMenuClick"); break;
                    case "onLoad": xlObj.option(args.value, "onLoad"); break;
                    case "onLoadComplete": xlObj.option(args.value, "onLoadComplete"); break;
                    case "editRangeBegin": xlObj.option(args.value, "editRangeBegin"); break;
                    case "editRangeComplete": xlObj.option(args.value, "editRangeComplete"); break;
                    case "onCellHover": xlObj.option(args.value, "onCellHover"); break;
                    case "cellSave": xlObj.option(args.value, "cellSave"); break;
                    case "beforeCellSelect": xlObj.option(args.value, "beforeCellSelect"); break;
                }
            }
            else xlObj.option(args.value, null);
        }
        function actionBegin(args) {
            jQuery.addEventLog("Spreadsheet <span class='eventTitle'>actionBegin</span> event called");
        }
        function actionComplete(args) {
            jQuery.addEventLog("Spreadsheet <span class='eventTitle'>actionComplete</span> event called");
        }
        function beforeCellFormat(args) {
            jQuery.addEventLog("Spreadsheet <span class='eventTitle'>beforeCellFormat</span> event called");
        }
        function beforeOpen(args) {
            jQuery.addEventLog("Spreadsheet <span class='eventTitle'>beforeOpen</span> event called");
        }
        function drag(args) {
            jQuery.addEventLog("Spreadsheet <span class='eventTitle'>drag</span> event called");
        }
        function cellEdit(args) {
            jQuery.addEventLog("Spreadsheet <span class='eventTitle'>cellEdit</span> event called");
        }
        function beforePanelOpen(args) {
            jQuery.addEventLog("Spreadsheet <span class='eventTitle'>beforePanelOpen</span> event called");
        }
        function cellClick(args) {
            jQuery.addEventLog("Spreadsheet <span class='eventTitle'>cellClick</span> event called");
        }
        function contextMenuClick(args) {
            jQuery.addEventLog("Spreadsheet <span class='eventTitle'>contextMenuClick</span> event called");
        }
        function onLoad(args) {
            jQuery.addEventLog("Spreadsheet <span class='eventTitle'>onLoad</span> event called");
        }
        function onLoadComplete(args) {
            jQuery.addEventLog("Spreadsheet <span class='eventTitle'>onLoadComplete</span> event called");
        }
        function editRangeBegin(args) {
            jQuery.addEventLog("Spreadsheet <span class='eventTitle'>editRangeBegin</span> event called");
        }
        function editRangeComplete(args) {
            jQuery.addEventLog("Spreadsheet <span class='eventTitle'>editRangeComplete</span> event called");
        }
        function onCellHover(args) {
            jQuery.addEventLog("Spreadsheet <span class='eventTitle'>onCellHover</span> event called");
        }
        function cellSave(args) {
            jQuery.addEventLog("Spreadsheet <span class='eventTitle'>cellSave</span> event called");
        }
        function beforeCellSelect(args) {
            jQuery.addEventLog("Spreadsheet <span class='eventTitle'>beforeCellSelect</span> event called");
        }
        function onClear() {
            $("#EventLog").html("");
        }
    </script>
</head>
<body>
    <div class="content-container-fluid">
        <div class="row">
            <div class="cols-sample-area">
                <div id="Spreadsheet"></div>
            </div>
            <div class="cols-prop-area event-tracer">
                <div>
                    <div class="heading">
                        <span>Event Trace</span>
                        <div class="pull-right">
                            <select name="selectevtprops" id="selectControls">
                                <option value="actionBegin">actionBegin</option>
                                <option value="actionComplete">actionComplete</option>
                                <option value="beforeCellFormat">beforeCellFormat</option>
                                <option value="beforeOpen">beforeOpen</option>
                                <option value="drag">drag</option>
                                <option value="cellEdit">cellEdit</option>
                                <option value="beforePanelOpen">beforePanelOpen</option>
                                <option value="cellClick">cellClick</option>
                                <option value="contextMenuClick">contextMenuClick</option>
                                <option value="onLoad">onLoad</option>
                                <option value="onLoadComplete">onLoadComplete</option>
                                <option value="editRangeBegin">editRangeBegin</option>
                                <option value="editRangeComplete">editRangeComplete</option>
                                <option value="onCellHover">onCellHover</option>
                                <option value="cellSave">cellSave</option>
                                <option value="beforeCellSelect">beforeCellSelect</option>
                            </select>
                        </div>
                    </div>
                    <div class="prop-grid content">
                        <div class="eventarea">
                            <div class="EventLog" id="EventLog">
                            </div>
                        </div>
                        <div class="evtbtn">
                            <input type="button" class="eventclear e-btn" value="Clear" onclick="onClear()" />
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</body>
</html>
